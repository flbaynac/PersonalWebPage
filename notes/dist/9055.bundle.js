"use strict";(self.webpackChunktagspaces=self.webpackChunktagspaces||[]).push([[9055],{83568:(e,t,r)=>{r.r(t),r.d(t,{default:()=>I,defaultSettings:()=>z});var n=r(85893),o=r(67294),i=r(24011),s=r(63274),l=r(5934),c=r(77297),a=r(74008),u=r(11157),g=r(76977),d=r(39905),h=r(75708),p=r(10941),D=r(65914),v=r(51405),y=r(44187),w=r(94898),S=r(36146),m=r(54820),T=r(31300),E=r(36808),C=r(43615),f=r(19412),x=r(54767),M=r(94315),F=r(310),P=r(4137),b=r(99794),A=r(36374),R=r(65186),B=r(65725),k=r(70285),L=r(36561),j=r(25108);function Z(e){return M.T&&e&&e.perspectiveSettings&&e.perspectiveSettings[P.TU.LIST]?e.perspectiveSettings[P.TU.LIST]:JSON.parse(localStorage.getItem(z.settingsKey))}const I=function(e){const{currentDirectoryPath:t,openRenameEntryDialog:r}=e,I=(0,i.I0)(),{sortedDirContent:N,sortBy:O,orderBy:U,setSortBy:G,setOrderBy:K}=(0,k.e)(),{openEntry:Y,openPrevFile:H,openNextFile:X}=(0,L.x)(),J=(0,i.v9)(y.ah),V=(0,i.v9)(y.vo),W=(0,i.v9)(y.Yl),q=(0,i.v9)(a.HK),Q=(0,i.v9)(y.lv),$=(0,i.v9)(y.Fv),_=(0,i.v9)(a.PP),ee=e=>{const t=Fe.current?e:e.filter((e=>e.isFile));I(y.Nw.setSelectedEntries(t))},te=e=>{I(y.Nw.openFileNatively(e))},re=M.T&&J&&J.perspectiveSettings&&J.perspectiveSettings[P.TU.LIST],ne=Z(J),oe=!(!M.T||!M.T.UI)&&M.T.UI.ShareFilesDialog,[ie,se]=(0,o.useState)(void 0),[le,ce]=(0,o.useState)(void 0),ae=(0,o.useRef)(void 0),ue=(0,o.useRef)(null),[ge,de]=(0,o.useState)(null),[he,pe]=(0,o.useState)(null),[De,ve]=(0,o.useState)(null),[ye,we]=(0,o.useState)(null),[Se,me]=(0,o.useState)(null),[Te,Ee]=(0,o.useState)(void 0),Ce=(0,o.useRef)(ne&&ne.layoutType?ne.layoutType:z.layoutType),fe=(0,o.useRef)(ne&&ne.singleClickAction?ne.singleClickAction:z.singleClickAction),xe=(0,o.useRef)(ne&&ne.entrySize?ne.entrySize:z.entrySize),Me=(0,o.useRef)(ne&&ne.thumbnailMode?ne.thumbnailMode:z.thumbnailMode),Fe=(0,o.useRef)(ne&&void 0!==ne.showDirectories?ne.showDirectories:z.showDirectories),Pe=(0,o.useRef)(ne&&void 0!==ne.showDetails?ne.showDetails:z.showDetails),be=(0,o.useRef)(ne&&void 0!==ne.showDescription?ne.showDescription:z.showDescription),Ae=(0,o.useRef)(ne&&void 0!==ne.showEntriesDescription?ne.showEntriesDescription:z.showEntriesDescription),Re=(0,o.useRef)(ne&&void 0!==ne.showTags?ne.showTags:z.showTags),[Be,ke]=(0,o.useState)(!1),[Le,je]=(0,o.useState)(!1),[Ze,Ie]=(0,o.useState)(!1),[ze,Ne]=(0,o.useState)(!1),Oe=(0,o.useRef)(ne&&ne.gridPageLimit?ne.gridPageLimit:z.gridPageLimit),Ue=(0,o.useRef)(void 0),[Ge,Ke]=(0,o.useReducer)((e=>e+1),0),Ye=(0,R.Z)();(0,o.useEffect)((()=>{1===Q.length&&He()}),[Q]),(0,o.useEffect)((()=>{if(!Ye){const e=Z(J);Fe.current=e&&void 0!==e.showDirectories?e.showDirectories:z.showDirectories,be.current=e&&void 0!==e.showDescription?e.showDescription:z.showDescription,Ae.current=e&&void 0!==e.showEntriesDescription?e.showEntriesDescription:z.showEntriesDescription,Pe.current=e&&void 0!==e.showDetails?e.showDetails:z.showDetails,Re.current=e&&void 0!==e.showTags?e.showTags:z.showTags,Ce.current=z.layoutType,K(e&&void 0!==e.orderBy?e.orderBy:z.orderBy),G(e&&void 0!==e.sortBy?e.sortBy:z.sortBy),fe.current=e&&void 0!==e.singleClickAction?e.singleClickAction:z.singleClickAction,xe.current=e&&void 0!==e.entrySize?e.entrySize:z.entrySize,Me.current=e&&void 0!==e.thumbnailMode?e.thumbnailMode:z.thumbnailMode,Oe.current=e&&void 0!==e.gridPageLimit?e.gridPageLimit:z.gridPageLimit,Ke()}}),[J]),(0,o.useEffect)((()=>{if(!Ye&&void 0!==Ue.current){const e={showDirectories:Fe.current,showDescription:be.current,showEntriesDescription:Ae.current,showDetails:Pe.current,showTags:Re.current,layoutType:Ce.current,orderBy:U,sortBy:O,singleClickAction:fe.current,entrySize:xe.current,thumbnailMode:Me.current,gridPageLimit:Oe.current};M.T&&!Ue.current?M.T.MetaOperations.savePerspectiveSettings(t,P.TU.LIST,e).then((e=>{I(y.Nw.setDirectoryMeta(e))})):(localStorage.setItem(z.settingsKey,JSON.stringify(e)),Ke()),Ue.current=void 0}}),[Ue.current,Fe.current,be.current,Ae.current,Pe.current,Re.current,Ce.current,U,O,fe.current,xe.current,Me.current,Oe.current]);const He=()=>{if(Q&&Q.length>0)try{const e=document.querySelector('[data-entry-id="'+Q[0].uuid+'"]');(0,l.isObj)(e)&&!(0,c.ex)(e)&&e.scrollIntoView(!1)}catch(e){j.debug("makeFirstSelectedEntryVisible:",e)}},Xe=e=>{const t=e?e.currentTarget:null;we(t)},Je=()=>{ee([]),ae.current=void 0},Ve=()=>{Q.length>1?Je():ee(W?A.Z.getInstance().getResults():N)},We=()=>{nt(),Fe.current=!Fe.current},qe=()=>{nt(),Re.current=!Re.current},Qe=()=>{nt();const e="cover"===Me.current?"contain":"cover";return Me.current=e,e},$e=e=>{nt(),xe.current=e},_e=e=>{nt(),fe.current=e},et=()=>{nt(),(0,B.zE)(F.Z.documentationLinks.defaultPerspective)},tt=()=>{nt(),Ne(!0)},rt=(e,t,r)=>{e.preventDefault(),e.stopPropagation(),ue.current=t,ae.current=r,ve(e.currentTarget)},nt=()=>{me(null)},ot=()=>{ke(!0)},it=()=>{je(!0)},st=()=>{I(y.Nw.toggleDeleteMultipleEntriesDialog())},lt=()=>{Ie(!0)},ct={nextDocument:_.nextDocument,prevDocument:_.prevDocument,selectAll:_.selectAll,deleteDocument:_.deleteDocument,addRemoveTags:_.addRemoveTags,renameFile:_.renameFile,openEntry:_.openEntry,openFileExternally:_.openFileExternally},at={nextDocument:()=>X(),prevDocument:()=>H(),selectAll:()=>Ve(),deleteDocument:()=>{(0,b.eB)(Q)&&st()},addRemoveTags:()=>{$&&lt()},renameFile:()=>{r()},openEntry:e=>{e.preventDefault(),Y()},openFileExternally:()=>{te()}},ut=N.filter((e=>!e.isFile)),gt=N.filter((e=>e.isFile));let dt=200;return"small"===xe.current?dt=150:"normal"===xe.current?dt=200:"big"===xe.current&&(dt=300),(0,n.jsxs)("div",{style:{height:"100%"},"data-tid":z.testID,children:[(0,n.jsx)(S.Z,{prefixDataTID:"list",toggleSelectAllFiles:Ve,openAddRemoveTagsDialog:lt,openMoveCopyFilesDialog:ot,handleSortingMenu:Xe,handleExportCsvMenu:()=>{M.T&&(Q&&Q.length>0?M.T.exportAsCsv.ExportAsCsv(Q):M.T.exportAsCsv.ExportAsCsv(N))},openSettings:tt,openShareFilesDialog:E.Z.haveObjectStoreSupport()?it:void 0}),(0,n.jsx)(s.GlobalHotKeys,{keyMap:ct,handlers:at,allowChanges:!0,children:(0,n.jsx)(C.Z,{gridPageLimit:Oe.current,style:{marginTop:5,marginBottom:70,paddingRight:4,paddingLeft:4,gridTemplateColumns:"none"},directories:ut,showDetails:Pe.current,showDescription:be.current,showDirectories:Fe.current,isReadOnlyMode:V,layoutType:Ce.current,desktopMode:q,openRenameEntryDialog:r,showTags:Re.current,thumbnailMode:Me.current,entrySize:xe.current,files:gt,getCellContent:(e,t,r,o,i,s,l)=>{let c=!1;return t&&t.some((t=>t.path===e.path))&&(c=!0),(0,n.jsx)(D.Z,{entryPath:e.path,selectedEntries:t.length>0?t:[e],children:(0,n.jsx)(w.Z,{selected:c,fsEntry:e,showEntriesDescription:Ae.current,entrySize:xe.current,isLast:l,thumbnailMode:Me.current,selectedEntries:t,selectEntry:e=>{ee([...t,e])},deselectEntry:e=>{const r=t.filter((t=>t.path!==e.path));ee(r)},handleTagMenu:rt,layoutType:Ce.current,showTags:Re.current,handleGridContextMenu:(e,t)=>{se(e.clientX),ce(e.clientY),o(e,t)},handleGridCellDblClick:s,handleGridCellClick:i})})},currentPage:1,currentDirectoryPath:t,onClick:e=>{e.preventDefault(),Q.length>0&&ee([])},onContextMenu:e=>{e.preventDefault(),se(e.clientX),ce(e.clientY),Q.length>0&&ee([]),pe(e.currentTarget)},settings:ne,selectedEntries:Q,setSelectedEntries:ee,singleClickAction:fe.current,openFileNatively:te,setFileContextMenuAnchorEl:de,setDirContextMenuAnchorEl:pe,showNotification:(e,t,r)=>{I(y.Nw.showNotification(e,t,r))},moveFiles:(e,t)=>I(v.Z.moveFiles(e,t)),clearSelection:Je})}),Ze&&(0,n.jsx)(h.Z,{open:Ze,onClose:()=>Ie(!1),selectedEntries:Q}),void 0!==Te&&(0,n.jsx)(x.Z,{open:!0,onClose:()=>Ee(void 0),selectedTag:Te}),ze&&(0,n.jsx)(f.Z,{open:ze,onClose:e=>{Ne(!1),Ue.current=e},setGridPageLimit:e=>{Oe.current=e},gridPageLimit:Oe.current,toggleShowDirectories:We,toggleShowTags:qe,toggleShowDetails:()=>{nt(),Pe.current=!Pe.current},toggleShowDescription:()=>{nt(),be.current=!be.current},toggleShowEntriesDescription:()=>{nt(),Ae.current=!Ae.current},showDetails:Pe.current,showDescription:be.current,showEntriesDescription:Ae.current,showDirectories:Fe.current,showTags:Re.current,toggleThumbnailsMode:Qe,thumbnailMode:Me.current,changeEntrySize:$e,entrySize:xe.current,changeSingleClickAction:_e,singleClickAction:fe.current,openHelpWebPage:et,handleSortingMenu:Xe,isLocal:re,resetLocalSettings:()=>{M.T.MetaOperations.savePerspectiveSettings(t,P.TU.LIST).then((e=>{I(y.Nw.setDirectoryMeta(e)),Ne(!1)}))}}),Be&&(0,n.jsx)(p.Z,{open:Be,onClose:()=>ke(!1)}),Le&&M.T&&(0,n.jsx)(oe,{open:Le,onClose:()=>je(!1)}),Boolean(ge)&&(0,n.jsx)(u.Z,{anchorEl:ge,mouseX:ie,mouseY:le,open:Boolean(ge),onClose:()=>de(null),openDeleteFileDialog:st,openRenameFileDialog:r,openMoveCopyFilesDialog:ot,openShareFilesDialog:E.Z.haveObjectStoreSupport()?it:void 0,openAddRemoveTagsDialog:lt,openFileNatively:te,selectedFilePath:$,selectedEntries:Q}),(0,n.jsx)(g.Z,{open:Boolean(he),onClose:()=>pe(null),anchorEl:he,mouseX:ie,mouseY:le,directoryPath:$,openRenameDirectoryDialog:r,openMoveCopyFilesDialog:ot,perspectiveMode:$!==t,openAddRemoveTagsDialog:lt}),(0,n.jsx)(d.Z,{anchorEl:De,open:Boolean(De),onClose:()=>ve(null),setIsAddTagDialogOpened:Ee,selectedTag:ue.current,currentEntryPath:ae.current}),Boolean(ye)&&(0,n.jsx)(m.Z,{open:Boolean(ye),onClose:()=>we(null),anchorEl:ye,handleSortBy:e=>{O!==e?G(e):K(!U),we(null)},searchModeEnabled:void 0!==W}),Boolean(Se)&&(0,n.jsx)(T.Z,{open:Boolean(Se),onClose:nt,anchorEl:Se,toggleShowDirectories:We,showDirectories:Fe.current,toggleShowTags:qe,showTags:Re.current,toggleThumbnailsMode:Qe,thumbnailMode:Me.current,entrySize:xe.current,changeSingleClickAction:_e,singleClickAction:fe.current,changeEntrySize:$e,openHelpWebPage:et,openSettings:tt})]})},z={testID:"listPerspectiveContainer",settingsKey:"tsPerspectiveList",orderBy:!0,sortBy:"byName",layoutType:"row",singleClickAction:"openInternal",entrySize:"small",thumbnailMode:"contain",showDirectories:!0,showDetails:!0,showDescription:!1,showEntriesDescription:!0,showTags:!0,gridPageLimit:100}}}]);
//# sourceMappingURL=9055.bundle.js.map